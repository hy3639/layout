<!doctype html>
<html lang="ko">
<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<title>하나은행 K포탈</title>
	<link rel="stylesheet" type="text/css" href="../../css/style.css">	

</head>

<body>
<div class="wrapper">
	<div class="header">
		<a href="#">헤더</a>
		<button type="button" class="btn-mid bg-green btnPop" title="Popup01">alert</button>
	</div> 
	<div class="container">
		<div class="lnb">
			<ul>
				<li>메뉴</li>
				<li>메뉴</li>
				<li>메뉴</li>
				<li>메뉴</li>
			</ul>

		</div>
		<div class="title">
			<div class="tit-area">
				<h2>화면명</h2>
				<button type="button" class="btn-input btn-mid bg-green" data="안녕하세요안녕하세요안녕하세요안녕하세요안녕하세요안녕하세요안녕하세요안녕하세요안녕하세요안녕하세요안녕하세요안녕하세요안녕하세요안녕하세요안녕하세요안녕하세요안녕하세요안녕하세요안녕하세요안녕하세요안녕하세요안녕하세요안녕하세요안녕하세요안녕하세요안녕하세요안녕하세요">버튼</button>
			</div>
		
		</div>
		<div class="contents">
			<div class="content flex">
				<div class="box chat-area">
					<div class="top">
						<h3 class="tit">1:1상담</h3>
						<div class="search-area">
							<div class="search-box">
								<input type="text" placeholder="검색어를 입력해 주세요.">
								<a href="#" class="btn-search">검색</a>
							</div>
						</div>
					</div>
					<div class="center">
						<div class="chat-wrap">
							<div class="chat-cont scroll-area2">
								<p>안녕1<br>안녕<br>안녕<br>
									안녕<br>안녕<br>안녕<br>안녕<br>안녕<br>안녕<br>안녕<br>안녕<br>안녕<br>
									안녕<br>안녕<br>안녕<br>안녕<br>안녕<br>안녕<br>안녕2<br>
									안녕<br>끝
									
								</p>
							</div>
							<div class="chat-box">								
								<textarea class="reHeight scroll-area2"></textarea>					
								<button type="button" class="btn-border" style="height: 100%;
								color: #000;border: 1px solid #ddd;border-left: 0;">전송</button>
							</div>
						</div>
						
					</div>
					<div class="bottom">
						<div class="btn-area">
							<button type="button" class="btn-lg bg-green">상담 종료</button>
						</div>
						<p style="height:30px;width:100%; background-color:#fad8db; color:#cc3a4a; text-align:center; font-size:12px">손님과 상담 시 금융소비자보호법 등 관련 법률을 준수하여 상담하시기 바랍니다.</p>
					</div>
				</div>
				<div class="box">
					<div class="top">
						<h3 class="tit">1:1상담</h3>
						<button type="button">도움말</button>
					</div>
					<div class="tab-wrap">
						<div class="tab-lst depth1">
							<div class="tab-item on">
								<button class="btn"><span class="txt">상담목록</span></button>
							</div>
							<div class="tab-item">
								<button class="btn"><span class="txt">즐겨찾기</span></button>
							</div>							
						</div>
						<div class="tab-conts">						
							<div class="tab-cont on">
								<ul class="chat-list scroll-area2">
									<li class="ui-state-default">item1 <button type="button" class="btn-chat-fixed">고정</button></li>
									<li class="ui-state-default">item2 <button type="button" class="btn-chat-fixed">고정</button></li>
									<li class="ui-state-default fixed">item3 <button type="button" class="btn-chat-fixed">고정</button></li>
									<li class="ui-state-default">item4 <button type="button" class="btn-chat-fixed">고정</button></li>
									<li class="ui-state-default">item5 <button type="button" class="btn-chat-fixed">고정</button></li>
									<li class="ui-state-default">item6 <button type="button" class="btn-chat-fixed">고정</button></li>
									<li class="ui-state-default">item7 <button type="button" class="btn-chat-fixed">고정</button></li>
									<li class="ui-state-default">item8 <button type="button" class="btn-chat-fixed">고정</button></li>
									<li class="ui-state-default">item9 <button type="button" class="btn-chat-fixed">고정</button></li>
									<li class="ui-state-default">item10 <button type="button" class="btn-chat-fixed">고정</button></li>
									<li class="ui-state-default">item11 <button type="button" class="btn-chat-fixed">고정</button></li>
									<li class="ui-state-default">item12<button type="button" class="btn-chat-fixed">고정</button></li>
									<li class="ui-state-default">item13<button type="button" class="btn-chat-fixed">고정</button></li>
									<li class="ui-state-default">item14 <button type="button" class="btn-chat-fixed">고정</button></li>
								  </ul>
							</div>						
							<div class="tab-cont">
								서브2
							</div>

						</div>
					</div>
				</div>
				<div class="box">3</div>
			</div>
			<div class="footer">
				footer
			</div>
		</div>
	</div>
	
</div>

<div class="layer-popup" title="Popup01">
	<div class="popup sm">
		<div class="popup-header">			
			<button class="btn-close popClose">팝업닫기</button>	
		</div>
		<div class="popup-cont">
			<p class="guide-txt align-center">일치하는 회원정보가 없습니다.</p>				
		</div>
		<div class="button-area  align-center">			
			<button type="button" class="btn-mid bg-green popClose">확인</button>			
		</div>
	</div>
</div>

<script src="../../js/jquery-3.4.1.min.js"></script>
<script src="../../js/jquery-ui.min.js"></script>
<script src="../../js/jquery.mCustomScrollbar.concat.min.js"></script>
<script src="../../js/common.js"></script>
<script>
	$(function(){

		
		

	sortableChat();
	function sortableChat(){
		$('.chat-list').sortable({
			axis: "y",
			containment: "parent",
			cursor: "move",
			tolerance: "pointer",
			items: 'li:not(.fixed)',
			cancel: ".fixed",
			start: function(){
				$('.fixed', this).each(function(){
					var $this = $(this);
					$this.data('pos', $this.index());
				});
			},
			change: function(){
				$sortable = $(this);
				$statics = $('.fixed', this).detach();
				$helper = $('<li></li>').prependTo(this);
				$statics.each(function(){
					var $this = $(this);
					var target = $this.data('pos');
					
					$this.insertAfter($('li', $sortable).eq(target));
				});
				$helper.remove();
			}
		});
	}
		
	$('.btn-chat-fixed').each(function(){
		$(this).click(function(){
			$selectChat = $(this).closest('li');
			if($selectChat.hasClass('fixed')){
				$selectChat.removeClass('fixed');
				
			}else{
				$selectChat.addClass('fixed');
			}			
			sortableChat();
			
		});
	});
	
		
		reHeight();		
		$('.btn-input').click(function(){
			var txt = $(this).attr('data');			
			$('.chat-box textarea').append(txt);

			var e = jQuery.Event("keydown");					
			$(".chat-box textarea").trigger(e);
			
		});
	
	});

// 	function reHeight(){
// 		$('.reHeight').each(function(){
// 			autoHeight();
// 			$(this).on('keydown keyup', function(){
// 				autoHeight();
// 			});

// 			function autoHeight(){
// 				$('.chat-box textarea').each(function(){
// 					var chatCont = $(this).closest('.chat-wrap').find('.chat-cont');
// 					var chatH = $('.chat-wrap').outerHeight();
// 					var chatInputH = $('.chat-box').find('textarea').outerHeight();
// 					var calcH  = chatH - chatInputH;

	
					
// 					$(this).css('height', 'auto').height(this.scrollHeight);			
// 					chatCont.css('height', calcH );

// 				});
// 			}
			
//     });
// }

function reHeight(){
		$('.reHeight').each(function(){
        autoHeight();
        $(this).on('keydown keyup', function(){
            autoHeight();
        });

        function autoHeight(){
			$('.chat-box textarea').each(function(){
                var chatCont = $(this).closest('.chat-wrap').find('.chat-cont');
				var chatH = $('.chat-wrap').outerHeight();
				var chatInputH = $('.chat-box').find('textarea').outerHeight();
				var calcH  = chatH - chatInputH;

				if(chatInputH > 399){
					$(this).css('overflow-y', 'auto');
				}else{
					$(this).css('overflow-y', 'hidden');
				}
				$(this).css('height', 'auto').height(this.scrollHeight);
				chatCont.css('height', calcH ).scrollTop(chatCont[0].scrollHeight);

			});
        }
    });
}




</script>

</body>
</html>